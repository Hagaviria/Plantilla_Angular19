import{a as Ce,b as xe,c as Se,d as je,e as we}from"./chunk-QY4DWN3J.js";import{$ as m,Aa as ue,Ca as fe,Db as W,E as s,Ea as ge,Fa as E,Fb as S,H as u,Hb as ke,I as k,Ib as N,K as te,Kb as he,L as x,N as l,Na as O,P as ae,Pa as D,Q as ie,Ra as K,S as ne,T as oe,Tb as ve,U as o,Ub as L,V as r,Vb as B,W as h,X as re,Y as se,_ as ce,a as _,aa as f,b as C,ba as pe,ca as le,d as Z,da as H,e as M,fa as Y,ga as J,ia as d,ja as v,ka as P,kc as be,lc as R,mc as b,n as F,nc as Te,o as g,oa as $,oc as ye,p as ee,pa as me,pc as _e,q as p,qc as j,s as Q,t as q,v as G,va as de,x as U}from"./chunk-OEDDXE3N.js";var T=class e{constructor(a){this.api=a}apiUrl="https://jsonplaceholder.typicode.com/todos";tasksSubject=new Z([]);tasks$=this.tasksSubject.asObservable();loadTasks(a){this.tasksSubject.value.length>0||this.api.get(`${this.apiUrl}?userId=${a}`).subscribe({next:t=>this.tasksSubject.next(t),error:()=>this.tasksSubject.next([])})}createTask(a){let t=this.tasksSubject.value,i=C(_({},a),{id:t.length>0?Math.max(...t.map(n=>n.id))+1:1});return this.tasksSubject.next([...t,i]),M(i)}updateTask(a,t){let i=this.tasksSubject.value,n=C(_({},t),{id:a});return this.tasksSubject.next(i.map(c=>c.id===a?n:c)),M(n)}deleteTask(a){let t=this.tasksSubject.value;return this.tasksSubject.next(t.filter(i=>i.id!==a)),M(void 0)}static \u0275fac=function(t){return new(t||e)(ee(Ce))};static \u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})};var $e=["icon"],Ee=["*"];function Oe(e,a){if(e&1&&h(0,"span",4),e&2){let t=f(2);l("ngClass",t.icon)}}function De(e,a){if(e&1&&(re(0),x(1,Oe,1,1,"span",3),se()),e&2){let t=f();s(),l("ngIf",t.icon)}}function Ne(e,a){}function Le(e,a){e&1&&x(0,Ne,0,0,"ng-template")}function Be(e,a){if(e&1&&(o(0,"span",5),x(1,Le,1,0,null,6),r()),e&2){let t=f();s(),l("ngTemplateOutlet",t.iconTemplate||t._iconTemplate)}}var Re=({dt:e})=>`
.p-tag {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    background: ${e("tag.primary.background")};
    color: ${e("tag.primary.color")};
    font-size: ${e("tag.font.size")};
    font-weight: ${e("tag.font.weight")};
    padding: ${e("tag.padding")};
    border-radius: ${e("tag.border.radius")};
    gap: ${e("tag.gap")};
}

.p-tag-icon {
    font-size: ${e("tag.icon.size")};
    width: ${e("tag.icon.size")};
    height:${e("tag.icon.size")};
}

.p-tag-rounded {
    border-radius: ${e("tag.rounded.border.radius")};
}

.p-tag-success {
    background: ${e("tag.success.background")};
    color: ${e("tag.success.color")};
}

.p-tag-info {
    background: ${e("tag.info.background")};
    color: ${e("tag.info.color")};
}

.p-tag-warn {
    background: ${e("tag.warn.background")};
    color: ${e("tag.warn.color")};
}

.p-tag-danger {
    background: ${e("tag.danger.background")};
    color: ${e("tag.danger.color")};
}

.p-tag-secondary {
    background: ${e("tag.secondary.background")};
    color: ${e("tag.secondary.color")};
}

.p-tag-contrast {
    background: ${e("tag.contrast.background")};
    color: ${e("tag.contrast.color")};
}
`,ze={root:({props:e})=>["p-tag p-component",{"p-tag-info":e.severity==="info","p-tag-success":e.severity==="success","p-tag-warn":e.severity==="warn","p-tag-danger":e.severity==="danger","p-tag-secondary":e.severity==="secondary","p-tag-contrast":e.severity==="contrast","p-tag-rounded":e.rounded}],icon:"p-tag-icon",label:"p-tag-label"},Ie=(()=>{class e extends he{name="tag";theme=Re;classes=ze;static \u0275fac=(()=>{let t;return function(n){return(t||(t=G(e)))(n||e)}})();static \u0275prov=F({token:e,factory:e.\u0275fac})}return e})();var X=(()=>{class e extends ve{get style(){return this._style}set style(t){this._style=t,this.cd.markForCheck()}styleClass;severity;value;icon;rounded;iconTemplate;templates;_iconTemplate;_style;_componentStyle=p(Ie);ngAfterContentInit(){this.templates?.forEach(t=>{switch(t.getType()){case"icon":this._iconTemplate=t.template;break}})}containerClass(){let t="p-tag p-component";return this.severity&&(t+=` p-tag-${this.severity}`),this.rounded&&(t+=" p-tag-rounded"),this.styleClass&&(t+=` ${this.styleClass}`),t}static \u0275fac=(()=>{let t;return function(n){return(t||(t=G(e)))(n||e)}})();static \u0275cmp=u({type:e,selectors:[["p-tag"]],contentQueries:function(i,n,c){if(i&1&&(H(c,$e,4),H(c,ke,4)),i&2){let I;Y(I=J())&&(n.iconTemplate=I.first),Y(I=J())&&(n.templates=I)}},hostVars:4,hostBindings:function(i,n){i&2&&(ae(n.style),ie(n.containerClass()))},inputs:{style:"style",styleClass:"styleClass",severity:"severity",value:"value",icon:"icon",rounded:[2,"rounded","rounded",de]},features:[$([Ie]),te],ngContentSelectors:Ee,decls:5,vars:3,consts:[[4,"ngIf"],["class","p-tag-icon",4,"ngIf"],[1,"p-tag-label"],["class","p-tag-icon",3,"ngClass",4,"ngIf"],[1,"p-tag-icon",3,"ngClass"],[1,"p-tag-icon"],[4,"ngTemplateOutlet"]],template:function(i,n){i&1&&(pe(),le(0),x(1,De,2,1,"ng-container",0)(2,Be,2,1,"span",1),o(3,"span",2),d(4),r()),i&2&&(s(),l("ngIf",!n.iconTemplate&&!n._iconTemplate),s(),l("ngIf",n.iconTemplate||n._iconTemplate),s(2),v(n.value))},dependencies:[E,ue,fe,ge,N],encapsulation:2,changeDetection:0})}return e})(),Me=(()=>{class e{static \u0275fac=function(i){return new(i||e)};static \u0275mod=k({type:e});static \u0275inj=g({imports:[X,N,N]})}return e})();var z=class e{task;edit=new U;delete=new U;editTask(){this.edit.emit(this.task.id)}deleteTask(){this.delete.emit(this.task.id)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-task-card"]],inputs:{task:"task"},outputs:{edit:"edit",delete:"delete"},decls:9,vars:4,consts:[[3,"value","severity"],[1,"actions"],["label","Editar","icon","pi pi-pencil",3,"click"],["label","Eliminar","icon","pi pi-trash","severity","danger",3,"click"]],template:function(t,i){t&1&&(o(0,"p-card")(1,"strong"),d(2),r(),o(3,"p"),d(4),r(),h(5,"p-tag",0),o(6,"div",1)(7,"p-button",2),m("click",function(){return i.editTask()}),r(),o(8,"p-button",3),m("click",function(){return i.deleteTask()}),r()()()),t&2&&(s(2),P("ID: ",i.task.id,""),s(2),v(i.task.title),s(),l("value",i.task.completed?"Completada":"Pendiente")("severity",i.task.completed?"success":"warn"))},dependencies:[B,L,b,R,be,Me,X],styles:["[_nghost-%COMP%]     .p-card{width:100%;display:flex;flex-direction:column;justify-content:space-between;border-radius:.75rem;box-shadow:0 4px 12px #00000014;transition:transform .2s ease,box-shadow .2s ease}  .p-button{cursor:pointer;border-radius:.75rem;transition:background .3s ease;gap:.5rem}.actions[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:25px;gap:12px}"]})};var qe=()=>[10,15,20],Ge=(e,a)=>a.id;function Ue(e,a){if(e&1){let t=ce();o(0,"app-task-card",9),m("edit",function(){let n=Q(t).$implicit,c=f();return q(c.editTask(n.id))})("delete",function(){let n=Q(t).$implicit,c=f();return q(c.deleteTask(n.id))}),r()}if(e&2){let t=a.$implicit;l("task",t)}}var A=class e{tasksService=p(T);route=p(O);router=p(D);confirmationService=p(W);messageService=p(S);projectId;tasks=[];paginatedTasks=[];first=0;rows=10;ngOnInit(){let a=this.route.snapshot.paramMap.get("id");if(!a){this.router.navigate(["/projects"]);return}let t=Number(a);if(Number.isNaN(t)){this.router.navigate(["/projects"]);return}this.projectId=t,this.loadTasks()}loadTasks(){this.tasksService.loadTasks(this.projectId),this.tasksService.tasks$.subscribe(a=>{this.tasks=a,this.updatePaginatedTasks()})}updatePaginatedTasks(){this.paginatedTasks=this.tasks.slice(this.first,this.first+this.rows)}onPageChange(a){this.first=a.first,this.rows=a.rows,this.updatePaginatedTasks()}addTask(){this.router.navigate(["/projects",this.projectId,"tasks","create"])}editTask(a){this.router.navigate(["/projects",this.projectId,"tasks",a,"edit"])}deleteTask(a){this.confirmationService.confirm({message:"\xBFEst\xE1s seguro de que deseas eliminar esta tarea?",header:"Confirmaci\xF3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.tasksService.deleteTask(a).subscribe(()=>{this.messageService.add({severity:"success",summary:"Eliminada",detail:"La tarea fue eliminada correctamente"})})}})}backToProjects(){this.router.navigate(["/projects"])}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-task-list"]],features:[$([W,S])],decls:14,vars:8,consts:[[1,"tasks-container"],[1,"tasks-header"],[1,"flex","gap-2"],["label","Volver","icon","pi pi-arrow-left","severity","secondary",3,"click"],["label","Nueva Tarea","icon","pi pi-plus",3,"click"],[1,"tasks-grid"],[3,"task"],[1,"tasks-paginator"],[3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showPageLinks"],[3,"edit","delete","task"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"div",1)(2,"h2"),d(3),r(),o(4,"div",2)(5,"p-button",3),m("click",function(){return i.backToProjects()}),r(),o(6,"p-button",4),m("click",function(){return i.addTask()}),r()()(),h(7,"p-toast")(8,"p-confirmDialog"),o(9,"div",5),ne(10,Ue,1,1,"app-task-card",6,Ge),r(),o(12,"div",7)(13,"p-paginator",8),m("onPageChange",function(c){return i.onPageChange(c)}),r()()()),t&2&&(s(3),P("Tareas del Proyecto ",i.projectId,""),s(7),oe(i.paginatedTasks),s(3),l("first",i.first)("rows",i.rows)("totalRecords",i.tasks.length)("rowsPerPageOptions",me(7,qe))("showCurrentPageReport",!0)("showPageLinks",!1))},dependencies:[z,Se,xe,b,R,E,ye,Te,we,je],styles:[".tasks-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding:.75rem 1rem;background:#fff;border-radius:.75rem;box-shadow:0 2px 6px #0000000d}.tasks-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600;color:#333}.tasks-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:1rem}[_nghost-%COMP%]     .p-card{height:100%;border-radius:.75rem;box-shadow:0 4px 12px #00000014;transition:transform .2s ease,box-shadow .2s ease}[_nghost-%COMP%]     .p-card:hover{transform:translateY(-3px);box-shadow:0 8px 18px #0000001f}.tasks-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:1rem}.tasks-paginator[_ngcontent-%COMP%]{margin-top:auto;padding-top:1rem;display:flex;justify-content:center}"]})};var w=class e{route=p(O);router=p(D);taskService=p(T);messageService=p(S);isEdit=!1;taskId;projectId;formFields=[];ngOnInit(){this.initializeForm()}initializeForm(){let a=this.route.snapshot.paramMap.get("id");this.projectId=a?Number(a):void 0;let t=this.route.snapshot.paramMap.get("taskId");this.taskId=t?Number(t):void 0,this.isEdit=!!this.taskId,this.isEdit?this.loadTaskForEdit():this.setDefaultFormFields()}loadTaskForEdit(){this.taskService.tasks$.subscribe(a=>{let t=a.find(i=>i.id===this.taskId);t&&(this.formFields=[new j({controlType:"textbox",key:"title",label:"Titulo",value:t.title,required:!0}),new j({controlType:"checkbox",key:"completed",label:"Completado",value:t.completed})])})}setDefaultFormFields(){this.formFields=[new j({controlType:"textbox",key:"title",label:"Titulo",value:"",required:!0}),new j({controlType:"checkbox",key:"completed",label:"Completado",value:!1})]}onCancel(){this.router.navigate([`/projects/${this.projectId}/tasks`])}onSubmit(a){this.isEdit?this.taskService.updateTask(this.taskId,a).subscribe(()=>{this.messageService.add({severity:"success",summary:"Tarea actualizada",detail:"La tarea se actualiz\xF3 correctamente"}),this.router.navigate([`/projects/${this.projectId}/tasks`])}):this.taskService.createTask(C(_({},a),{projectId:this.projectId})).subscribe(()=>{this.messageService.add({severity:"success",summary:"Tarea creada",detail:"La tarea se cre\xF3 correctamente"}),this.router.navigate([`/projects/${this.projectId}/tasks`])})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=u({type:e,selectors:[["app-task-form"]],decls:6,vars:4,consts:[[1,"form-container"],[1,"form-card"],[3,"formSubmit","cancel","formFields","showCancel","labelSubmit"]],template:function(t,i){t&1&&(o(0,"div",0)(1,"p-card",1)(2,"div")(3,"h2"),d(4),r()(),o(5,"app-generic-form",2),m("formSubmit",function(c){return i.onSubmit(c)})("cancel",function(){return i.onCancel()}),r()()()),t&2&&(s(4),v(i.isEdit?"Editar Tarea":"Nueva Tarea"),s(),l("formFields",i.formFields)("showCancel",!0)("labelSubmit",i.isEdit?"Actualizar":"Crear"))},dependencies:[_e,b,B,L],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:80vh}.form-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#30809d}"]})};var He=[{path:"",component:A},{path:"create",component:w},{path:":taskId/edit",component:w}],V=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=k({type:e});static \u0275inj=g({imports:[K.forChild(He),K]})};var Pe=class e{static \u0275fac=function(t){return new(t||e)};static \u0275mod=k({type:e});static \u0275inj=g({imports:[V]})};export{Pe as TasksModule};
