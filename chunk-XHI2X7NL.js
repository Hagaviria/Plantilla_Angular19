import{a as te}from"./chunk-4SOBHILN.js";import{a as oe,b as re,c as M,d as ie,e as ne}from"./chunk-QY4DWN3J.js";import{$ as p,Db as W,E as m,Fa as K,Fb as g,G as q,H as u,Hb as X,I as _,L as B,N as d,Na as Q,Nb as Y,P as z,Pa as j,Ra as R,S as G,T as J,U as i,Ub as w,V as c,Vb as Z,W as O,a as I,aa as U,b as D,e as y,g as H,ia as f,j as L,ja as b,lc as F,mc as k,n as A,o as C,p as V,pa as S,pc as ee,q as a,qc as h,ya as $,z as N}from"./chunk-OEDDXE3N.js";var l=class r{constructor(e){this.api=e}apiUrl="https://jsonplaceholder.typicode.com/users";projects=N([]);loading=N(!1);loadProjects(){this.loading.set(!0),this.api.get(this.apiUrl).pipe(H(e=>e.map(t=>({id:t.id,title:t.name,description:t.company?.catchPhrase}))),L(()=>this.loading.set(!1))).subscribe({next:e=>this.projects.set(e),error:()=>this.projects.set([])})}createProject(e){let t=this.projects(),o=t.length>0?Math.max(...t.map(s=>s.id)):0,n=D(I({},e),{id:o+1});return this.projects.update(s=>[...s,n]),y(n)}updateProject(e,t){let o=D(I({},t),{id:e});return this.projects.update(n=>n.map(s=>s.id===e?o:s)),y(o)}deleteProject(e){return this.projects.update(t=>t.filter(o=>o.id!==e)),y(void 0)}static \u0275fac=function(t){return new(t||r)(V(oe))};static \u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"})};var me=()=>({padding:"1rem",overflow:"hidden"}),T=class r{project;router=a(j);projectsService=a(l);messageService=a(g);confirmationService=a(W);goToTasks(e){this.router.navigate(["/projects",e,"tasks"])}editProject(e){this.router.navigate(["/projects",e,"edit"])}deleteProject(e){this.confirmationService.confirm({message:"\xBFEliminar este proyecto?",header:"Confirmaci\xF3n",icon:"pi pi-exclamation-triangle",accept:()=>{this.projectsService.deleteProject(e).subscribe(()=>{this.messageService.add({severity:"success",summary:"Proyecto eliminado",detail:"El proyecto se elimin\xF3 correctamente"})})}})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=u({type:r,selectors:[["app-project-card"]],inputs:{project:"project"},decls:6,vars:6,consts:[[1,"",3,"header","subheader"],["label","Ver tareas","icon","pi pi-list","severity","info",3,"click"],["label","Editar","icon","pi pi-pencil",1,"ml-2",3,"click"],["label","Eliminar","icon","pi pi-trash","severity","danger",1,"ml-2",3,"click"]],template:function(t,o){t&1&&(i(0,"p-card",0)(1,"p"),f(2),c(),i(3,"p-button",1),p("click",function(){return o.goToTasks(o.project.id)}),c(),i(4,"p-button",2),p("click",function(){return o.editProject(o.project.id)}),c(),i(5,"p-button",3),p("click",function(){return o.deleteProject(o.project.id)}),c()()),t&2&&(z(S(5,me)),d("header",o.project.title)("subheader","ID: "+o.project.id),m(2),b(o.project.description))},dependencies:[w,F,M],encapsulation:2})};var le=()=>[3,6,9],de=(r,e)=>e.id;function ue(r,e){if(r&1&&O(0,"app-project-card",7),r&2){let t=e.$implicit;d("project",t)}}var E=class r{constructor(e){this.router=e;$(()=>{this.updatePaginatedProjects()})}projectsService=a(l);authService=a(te);messageService=a(g);projects=this.projectsService.projects;loading=this.projectsService.loading;paginatedProjects=[];first=0;rows=9;ngOnInit(){this.projects().length===0&&this.projectsService.loadProjects()}onPageChange(e){this.first=e.first,this.rows=e.rows,this.updatePaginatedProjects()}updatePaginatedProjects(){this.paginatedProjects=this.projects().slice(this.first,this.first+this.rows)}createNewProject(){this.router.navigate(["/projects","create"])}logout(){this.authService.logout(),this.messageService.add({severity:"info",summary:"Sesi\xF3n cerrada",detail:"Has salido de la aplicaci\xF3n"}),this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||r)(q(j))};static \u0275cmp=u({type:r,selectors:[["app-project-home"]],decls:13,vars:8,consts:[[1,"projects-container"],[1,"projects-header"],[1,"m-0"],[1,"flex","gap-2"],["label","Nuevo Proyecto",3,"click","keydown.enter"],["label","Logout","severity","secondary","icon","pi pi-sign-out",3,"click","keydown.enter"],[1,"projects-grid"],[3,"project"],[1,"projects-paginator"],[3,"onPageChange","first","rows","totalRecords","rowsPerPageOptions","showCurrentPageReport","showPageLinks","showJumpToPageDropdown"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),f(3,"Lista de Proyectos"),c(),i(4,"div",3)(5,"p-button",4),p("click",function(){return o.createNewProject()})("keydown.enter",function(){return o.createNewProject()}),c(),i(6,"p-button",5),p("click",function(){return o.logout()})("keydown.enter",function(){return o.logout()}),c()()(),i(7,"div",6),G(8,ue,1,1,"app-project-card",7,de),c(),i(10,"div",8)(11,"p-paginator",9),p("onPageChange",function(s){return o.onPageChange(s)}),c()()(),O(12,"p-confirmDialog")),t&2&&(m(8),J(o.paginatedProjects),m(3),d("first",o.first)("rows",o.rows)("totalRecords",o.projects().length)("rowsPerPageOptions",S(7,le))("showCurrentPageReport",!0)("showPageLinks",!1)("showJumpToPageDropdown",!1))},dependencies:[K,T,k,F,ne,ie,M,re],styles:[".projects-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding:.5rem 1rem;background:#fff;border-radius:.75rem;box-shadow:0 2px 6px #0000000d}.projects-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:2rem}[_nghost-%COMP%]     .p-card{width:100%;display:flex;flex-direction:column;justify-content:space-between;border-radius:.75rem;box-shadow:0 4px 12px #00000014;transition:transform .2s ease,box-shadow .2s ease}.projects-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;padding:1rem}.projects-paginator[_ngcontent-%COMP%]{margin-top:auto;padding-top:1rem;display:flex;justify-content:center}"]})};function ce(r){return e=>e.value&&e.value.trim().length<r?{minLengthCustom:{requiredLength:r,actualLength:e.value.length}}:null}function se(r){return e=>e.value&&r.projects().some(o=>o.title.toLowerCase()===e.value.toLowerCase())?{projectNameExists:!0}:null}function fe(r,e){if(r&1&&(i(0,"h2"),f(1),c()),r&2){let t=U();m(),b(t.isEdit?"Editar Proyecto":"Nuevo Proyecto")}}var P=class r{route=a(Q);router=a(j);projectsService=a(l);messageService=a(g);isEdit=!1;projectId;formFields=[];ngOnInit(){this.initializeForm()}initializeForm(){let e=this.route.snapshot.paramMap.get("id");this.projectId=e?Number(e):void 0,this.isEdit=!!this.projectId,this.isEdit?this.loadProjectForEdit():this.setDefaultFormFields()}loadProjectForEdit(){let e=this.projectsService.projects().find(t=>t.id===this.projectId);e&&(this.formFields=[new h({controlType:"textbox",key:"title",label:"Title",value:e.title,required:!0}),new h({controlType:"textarea",key:"description",label:"Description",value:e.description,required:!0})])}setDefaultFormFields(){this.formFields=[new h({controlType:"textbox",key:"title",label:"Titulo",value:"",required:!0,validators:[Y.required,ce(3),se(this.projectsService)]}),new h({controlType:"textarea",key:"description",label:"Descripci\xF3n",value:"",required:!0})]}goBack(){this.router.navigate(["/projects"])}onSubmit(e){this.isEdit?this.projectsService.updateProject(this.projectId,e).subscribe(()=>{this.messageService.add({severity:"success",summary:"Proyecto actualizado",detail:"El proyecto se actualiz\xF3 correctamente"}),this.router.navigate(["/projects"])}):this.projectsService.createProject(e).subscribe(()=>{this.messageService.add({severity:"success",summary:"Proyecto creado",detail:"El proyecto se cre\xF3 correctamente"}),this.router.navigate(["/projects"])})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=u({type:r,selectors:[["app-project-form"]],decls:4,vars:3,consts:[[1,"form-container"],[1,"form-card"],["pTemplate","header"],[3,"formSubmit","cancel","formFields","showCancel","labelSubmit"]],template:function(t,o){t&1&&(i(0,"div",0)(1,"p-card",1),B(2,fe,2,1,"ng-template",2),i(3,"app-generic-form",3),p("formSubmit",function(s){return o.onSubmit(s)})("cancel",function(){return o.goBack()}),c()()()),t&2&&(m(3),d("formFields",o.formFields)("showCancel",!0)("labelSubmit",o.isEdit?"Actualizar":"Crear"))},dependencies:[ee,k,X,Z,w],styles:[".form-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:80vh}.form-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#30809d}"]})};var je=[{path:"",component:E},{path:"create",component:P},{path:":id/edit",component:P},{path:":id/tasks",loadChildren:()=>import("./chunk-4E3P2EBM.js").then(r=>r.TasksModule)}],x=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=_({type:r});static \u0275inj=C({imports:[R.forChild(je),R]})};var pe=class r{static \u0275fac=function(t){return new(t||r)};static \u0275mod=_({type:r});static \u0275inj=C({imports:[x]})};export{pe as ProjectsModule};
